{% extends 'base.html.twig' %}
{% block title %}Computometrico {% endblock %}
{% block body %}
    <div class="main-panel">
        <div class="content-wrapper">
            <div class="row">
                <div class="col-11">
                    <h3>Preventivi <small>Computometrico</small></h3>
                </div>
                <div class="col-1">
                    <div class="btn-group float-right action-buttons">
                        <a href="{{ url('mostra_preventivo_avanzato', {'pid': item.pid}) }}" class="btn btn-secondary btn-sm float-right ">
                            <i class="fa fa-chevron-left mr-0"></i> &nbsp; Indietro
                        </a>
                        <a href="" class="btn btn-success btn-sm float-right " id="print">
                            <i class="mdi mdi-printer mr-0"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% for label, messages in app.flashes %}
                {% for message in messages %}
                    <div class="alert alert-{{ label }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endfor %}
            <div class="row">
                <div class="col-lg-12 grid-margin stretch-card">
                    <div class="card" id="page">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover border-o">
                                    <thead>
                                    <tr>
                                        <th class="no-wrap border">ARTICOLO</th>
                                        <th class="border" style="max-width: 300px">DESCRIZIONE</th>
                                        <th class="no-wrap border">QUANTITÁ</th>
                                        <th class="no-wrap border">PREZZO NETTO UNITARIO</th>
                                        <th class="no-wrap border">PREZZO NETTO TOTALE</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% set prices = [] %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><strong>PUNTI LUCE – COMANDO - PRESA</strong></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Punti Luce</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.1.12.2</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                P.to luce semplice su canalizzazione in traccia o in vista <br>
                                                con un cavo non propagante l'incendio con sezione minima 1,5 mmq. <br>
                                                <strong>Per P.to luce con conduttore di protezione.</strong>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPL }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.1.12.2')|number_format(2)  }}</td>
                                        <td class="border text-center">{{ (qtyPL * fun.getPriceByCode('15.1.12.2'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPL * fun.getPriceByCode('15.1.12.2')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.1.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Canalizzazione per <strong>P.to luce in traccia</strong> per distanza non superiori a 60mt. <br>
                                                Sono esclusi i conduttori e le opere murarie.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPL }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.1.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPL * fun.getPriceByCode('15.1.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPL * fun.getPriceByCode('15.1.1')]) %}
                                    </tr>
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                        <tr>
                                            <td class="border text-center">15.1.3.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per P.to luce per opere murarie su murature <strong>NON Intonacate.</strong> <br>
                                                    Sono esclusi: l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPL }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.3.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPL * fun.getPriceByCode('15.1.3.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPL * fun.getPriceByCode('15.1.3.1')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurarieIntonaco == 1 and item.opereMurariePietra == 0 %}
                                        <tr>
                                            <td class="border text-center">15.1.4.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per P.to luce per opere murarie su murature <strong>Intonacate.</strong> <br>
                                                    Sono esclusi: l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPL }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.4.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPL * fun.getPriceByCode('15.1.4.1'))|number_format(2) }}</td>
                                        </tr>
                                        {% set prices = prices|merge([qtyPL * fun.getPriceByCode('15.1.4.1')]) %}
                                    {% endif %}
                                    {% if item.opereMurariePietra == 1 %}
                                        <tr>
                                            <td class="border text-center">15.1.5.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per P.to luce per opere murarie su murature in <strong>mattone pieno, calcestruzzo o pietra.</strong> <br>
                                                    Sono esclusi: l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPL }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.5.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPL * fun.getPriceByCode('15.1.5.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPL * fun.getPriceByCode('15.1.5.1')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light">
                                            <strong>
                                                N.B.: il montaggio dei corpi illuminanti è escluso dalla presente offerta. Una volta che questi saranno stati definiti potremo fare un'offerta per<br>
                                                l'installazione se quantificabile, altrimenti procederemo nelle lavorazioni in economia con le tariffe orarie pattuite in fase di contratto. <br>
                                                Nel caso non venissero definiti prima della fine dei lavori o l'eventuale installazione non sia di nostra competenza, da parte nostra provvederemo <br>
                                                all'installazione di almeno un portalampade per ambiente. Eventuali accessori, se necessari, tipo tubazione rame e/o cavo in seta, verranno conteggiati<br>
                                                a parte con rendicontazione finale.
                                            </strong>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Punti di Comando</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.1.15.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                P.to di comando su canalizzazione in traccia o in vista
                                                con un cavo non propagante l'incendio <br>
                                                <strong>Per P.to di comando.</strong>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPC }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.1.15.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPC * fun.getPriceByCode('15.1.15.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPC * fun.getPriceByCode('15.1.15.1')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.1.2</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Canalizzazione per <strong>P.to di comando in traccia</strong> per distanza non superiori a 60mt. <br>
                                                Sono esclusi i conduttori e le opere murarie.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPC }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.1.2')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPC * fun.getPriceByCode('15.1.2'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPC * fun.getPriceByCode('15.1.2')]) %}
                                    </tr>
                                    {% if itemsArray.7 > 0 %}
                                    <tr>
                                        <td class="border text-center">15.1.15.2</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Punto di comando aggiuntivo sulla stessa scatola. Per P.to di comando aggiuntivo
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.7 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.1.15.2')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.7 * fun.getPriceByCode('15.1.15.2'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.7  * fun.getPriceByCode('15.1.15.2')]) %}
                                    </tr>
                                    {% endif %}
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                        <tr>
                                            <td class="border text-center">15.1.3.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to di comando per opere murarie su murature <br>
                                                    <strong>NON Intonacate.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPC }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.3.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPC * fun.getPriceByCode('15.1.3.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPC * fun.getPriceByCode('15.1.3.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurarieIntonaco == 1 and item.opereMurariePietra == 0 %}
                                        <tr>
                                            <td class="border text-center">15.1.4.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to di comando per opere murarie su murature <br>
                                                    <strong>Intonacate.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPC }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.4.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPC * fun.getPriceByCode('15.1.4.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPC * fun.getPriceByCode('15.1.4.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurariePietra == 1 %}
                                        <tr>
                                            <td class="border text-center">15.1.5.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to di comando per opere murarie su murature in <br>
                                                    <strong>mattone pieno, calcestruzzo pietra.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPC }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.5.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPC * fun.getPriceByCode('15.1.5.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPC * fun.getPriceByCode('15.1.5.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if itemsArray.3 != null %}
                                        <tr>
                                            <td class="border text-center">15.1.15.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    P.to di comando aggiuntivo sulla stessa scatola. Per P.to di comando aggiuntivo.
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.3 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.1.15.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.3 * fun.getPriceByCode('15.1.15.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.3 * fun.getPriceByCode('15.1.15.2')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Punti Presa</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.2.21.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                P.to allaccio per presa monofase su canalizzazione in traccia o in vista <br>
                                                con cavo non propagante l'incendio di sezione idonea<br>
                                                <strong>Per allaccio monofase con carico massimo di 16A.</strong>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPP }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.2.21.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPP * fun.getPriceByCode('15.2.21.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPP * fun.getPriceByCode('15.2.21.1')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.2.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Canalizzazione per <strong>P.to Presa in traccia</strong> per distanza non superiori a 60 mt. <br>
                                                Sono esclusi i conduttori e le opere murarie<br>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPP }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.2.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPP * fun.getPriceByCode('15.2.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPP * fun.getPriceByCode('15.2.1')]) %}
                                    </tr>
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                        <tr>
                                            <td class="border text-center">15.2.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to di comando per opere murarie su murature <br>
                                                    <strong>NON Intonacate.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPP }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.2.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPP * fun.getPriceByCode('15.2.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPP * fun.getPriceByCode('15.2.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurarieIntonaco == 1 and item.opereMurariePietra == 0 %}
                                        <tr>
                                            <td class="border text-center">15.2.3</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to di comando per opere murarie su murature <br>
                                                    <strong>Intonacate.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPP }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.2.3')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPP * fun.getPriceByCode('15.2.3'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPP * fun.getPriceByCode('15.2.3')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurariePietra == 1 %}
                                        <tr>
                                            <td class="border text-center">15.2.4</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to di comando per opere murarie su murature in <br>
                                                    <strong>mattone pieno, calcestruzzo pietra.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPP }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.2.4')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPP * fun.getPriceByCode('15.2.4'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPP * fun.getPriceByCode('15.2.4')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td class="border text-center">15.2.41.3</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Punto presa elettrica da collegare alla linea di alimentazione compensata a parte come allaccio elettrico. <br>
                                                Pt.o presa elettrica 2P+T 10/16A + UNEL. (Schuko Bipasso)<br>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPP }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.2.41.3')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPP * fun.getPriceByCode('15.2.41.3'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPP * fun.getPriceByCode('15.2.41.3')]) %}
                                    </tr>
                                    {% if itemsArray.4 > 0 %}
                                    <tr>
                                        <td class="border text-center">15.2.41.2</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Presa elettrica aggiuntiva sulla stessa scatola 2P+T 10A o 16A o 10/16A (Bipresa) <br>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.4 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.2.41.2')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.4 * fun.getPriceByCode('15.2.41.2'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.4 * fun.getPriceByCode('15.2.41.2')]) %}
                                    </tr>
                                    {% endif %}
                                    {% if itemsArray.5 > 0 %}
                                        <tr>
                                            <td class="border text-center">15.2.42</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Per allaccio ventilatori e o aspiratori
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.5 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.2.42')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.5 * fun.getPriceByCode('15.2.42'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.5 * fun.getPriceByCode('15.2.42')]) %}
                                        </tr>
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><strong>SERVIZI</strong></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Punti Presa di Servizio: TV Terrestre, TV Satellitare, Emergenza, Telefono, Rete Dati, Citofonia</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.3.10.0</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                PUNTO PRESA DI SERVIZIO in traccia sono escluse le opere murarie
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPS }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.3.10')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPS * fun.getPriceByCode('15.3.10'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPS * fun.getPriceByCode('15.3.10')]) %}
                                    </tr>
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                        <tr>
                                            <td class="border text-center">15.3.20.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature <br>
                                                    <strong>NON Intonacate.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPS }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.20.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPS * fun.getPriceByCode('15.3.20.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPS * fun.getPriceByCode('15.3.20.1')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurarieIntonaco == 1 and item.opereMurariePietra == 0 %}
                                        <tr>
                                            <td class="border text-center">15.3.20.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature <br>
                                                    <strong>Intonacate.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPS }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.20.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPS * fun.getPriceByCode('15.3.20.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPS * fun.getPriceByCode('15.3.20.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurariePietra == 1 %}
                                        <tr>
                                            <td class="border text-center">15.3.20.3</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature in <br>
                                                    <strong>mattone pieno, calcestruzzo pietra.</strong> Sono esclusi l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPS }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.20.3')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPS * fun.getPriceByCode('15.3.20.3'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPS * fun.getPriceByCode('15.3.20.3')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.antenna > 0 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><i>Impianto TV terrestre</i></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.151.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Impianto di ricezione di segnale TV digitale terrestre <strong>costituito da antenna di ricezione TV in <br>
                                                        banda UHF o VHF</strong>, idonea alla ricezione di segnale TV digitale terrestre con guadagno <br>
                                                    compreso superiore a 13 dB,  con possibilità di installazione con polarizzazione verticale o <br>
                                                    orizzontale, <strong>completa di palo e di sistemi di fissaggio su tetto o su copertura piana di <br>
                                                        qualsiasi natura, di cavi di collegamento fino all'impianto di amplificazione.</strong> Il tutto posto in <br>
                                                    opera a qualsiasi altezza, con tutto quanto occorre per dare il lavoro finito , incluse le eventuali <br>
                                                    opere murarie per il fissaggio ed il ripristino di eventuali parti  di copertura interessate. <br>
                                                    <strong>Sistema con due antenne</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.151.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.151.2')|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.3.151.2')]) %}
                                        </tr>
                                        {% if qtyPT < 5 %}
                                            <tr>
                                                <td class="border text-center">15.3.161.1</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Amplificatore da palo per segnale TV digitale terrestre, per banda larga UHF - VHF, completo di <br>
                                                        alimentatore e quota di cavo a basse perdite per linea montante su canalizzazione predisposta, <br>
                                                        per la distribuzione del segnale derivato dalle antenne di ricezione, fino ai partitori. Posto in <br>
                                                        opera su palo o all'interno completo degli accessori necessari per dare l'opera finita e <br>
                                                        funzionante. <strong>Per alimentazione  fino a 5 prese</strong>
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.3.161.1')|number_format(2) }}</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.3.161.1')|number_format(2) }}</td>
                                                {% set prices = prices|merge([fun.getPriceByCode('15.3.161.1')]) %}
                                            </tr>
                                        {% elseif qtyPT > 6 and qtyPT < 10 %}
                                            <tr>
                                                <td class="border text-center">15.3.161.2</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Amplificatore da palo per segnale TV digitale terrestre, per banda larga UHF - VHF, completo di <br>
                                                        alimentatore e quota di cavo a basse perdite per linea montante su canalizzazione predisposta, <br>
                                                        per la distribuzione del segnale derivato dalle antenne di ricezione, fino ai partitori. Posto in <br>
                                                        opera su palo o all'interno completo degli accessori necessari per dare l'opera finita e <br>
                                                        funzionante. <strong>Per alimentazione da 6 a 10 prese</strong>
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.3.161.2')|number_format(2) }}</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.3.161.2')|number_format(2) }}</td>
                                                {% set prices = prices|merge([fun.getPriceByCode('15.3.161.2')]) %}
                                            </tr>
                                        {% elseif qtyPT > 11 and qtyPT < 15 %}
                                            <tr>
                                                <td class="border text-center">15.3.161.3</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Amplificatore da palo per segnale TV digitale terrestre, per banda larga UHF - VHF, completo di <br>
                                                        alimentatore e quota di cavo a basse perdite per linea montante su canalizzazione predisposta, <br>
                                                        per la distribuzione del segnale derivato dalle antenne di ricezione, fino ai partitori. Posto in <br>
                                                        opera su palo o all'interno completo degli accessori necessari per dare l'opera finita e <br>
                                                        funzionante. <strong>Per alimentazione da 11 a 15 prese</strong>
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.3.161.3')|number_format(2) }}</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.3.161.3')|number_format(2) }}</td>
                                                {% set prices = prices|merge([fun.getPriceByCode('15.3.161.3')]) %}
                                            </tr>
                                        {% endif %}
                                    {% endif %}
                                    <tr>
                                        <td class="border text-center">15.3.110.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Incremento al punto presa di servizio per <strong>presa di ricezione TV terrestre</strong>
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPT }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.3.110.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPT * fun.getPriceByCode('15.3.110.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPT * fun.getPriceByCode('15.3.110.1')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.4.230.0</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Cavo coassiale per impianti di antenna TV  al metro per linea dorsale
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ calcTVCable }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.4.230')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (calcTVCable * fun.getPriceByCode('15.4.230'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([calcTVCable * fun.getPriceByCode('15.4.230')]) %}
                                    </tr>
                                    {#{% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                        <tr>
                                            <td class="border text-center">15.3.20.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature NON Intonacate. <br>
                                                    Sono esclusi: l’intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPT }}</td>
                                            <td class="border text-center">8</td>
                                            <td class="border text-center">{{ qtyPT  * 8}}</td>
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 1  %}
                                        <tr>
                                            <td class="border text-center">15.3.20.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature Intonacate. <br>
                                                    Sono esclusi: l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPT }}</td>
                                            <td class="border text-center">12.9</td>
                                            <td class="border text-center">{{ qtyPT * 12.9 }}</td>
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurariePietra == 1 %}
                                        <tr>
                                            <td class="border text-center">15.3.20.32</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Maggiorazione per opere murarie su muratura in mattone pieno, calcestruzzo o pietra.
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPT }}</td>
                                            <td class="border text-center">12.1</td>
                                            <td class="border text-center">{{ qtyPT  * 12.1}}</td>
                                        </tr>
                                    {% endif %}#}
                                    {% if qtyTR != 0 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><i>Impianto chiamata emergenza con tiranti dal bagno e delle camere da letto</i></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.40.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento al punto presa di servizio per <strong>impianto di chiamata</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyTR }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.40.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyTR * fun.getPriceByCode('15.3.40.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyTR * fun.getPriceByCode('15.3.40.1')]) %}
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.90.0</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento al punto presa di servizio per segnalatore acustico di tipo a <strong>ronzatore per EMERGENZE</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyTR }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.90')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyTR * fun.getPriceByCode('15.3.90'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyTR * fun.getPriceByCode('15.3.90')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.numPreseTelefono != 0 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><i>Impianto Telefonico</i></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.210.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento al punto presa di servizio per <strong>presa telefonica</strong> con presa ad 1 coppia
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyTP }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.210.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyTP * fun.getPriceByCode('15.3.210.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyTP * fun.getPriceByCode('15.3.210.1')]) %}
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.4.240.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Linea telefonica in cavo multicoppie a 2 coppie al metro per linea dorsale
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ calcTPCable|number_format(0) }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.4.240.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (calcTPCable|number_format(0) * fun.getPriceByCode('15.4.240.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([calcTPCable * fun.getPriceByCode('15.4.240.1')]) %}
                                        </tr>
                                        {#{% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                            <tr>
                                                <td class="border text-center">15.3.20.1</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature NON Intonacate. <br>
                                                        Sono esclusi: l’intonaco, la rasatura e la tinteggiatura
                                                    </small>
                                                </td>
                                                <td class="border text-center">{{ qtyTP }}</td>
                                                <td class="border text-center">8.00</td>
                                                <td class="border text-center">{{ qtyTP  * 8.00}}</td>
                                            </tr>
                                        {% endif %}
                                        {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 1  %}
                                            <tr>
                                                <td class="border text-center">15.3.20.2</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature Intonacate. <br>
                                                        Sono esclusi: l'intonaco, la rasatura e la tinteggiatura
                                                    </small>
                                                </td>
                                                <td class="border text-center">{{ qtyPT }}</td>
                                                <td class="border text-center">12.9</td>
                                                <td class="border text-center">{{ qtyPT * 12.9 }}</td>
                                            </tr>
                                        {% endif %}
                                        {% if item.opereMurariePietra == 1 %}
                                            <td class="border text-center">15.3.20.3</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Maggiorazione per opere murarie su muratura in mattone pieno, calcestruzzo o pietra.
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyTP }}</td>
                                            <td class="border text-center">12.1</td>
                                            <td class="border text-center">{{ (qtyTP * 12.10)|number_format(1)}}</td>
                                        {% endif %}#}
                                    {% endif %}
                                    {% if item.numPreseDati != 0 and item.level == 3 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><i>Connettorizzazione punti trasmissione dati.</i></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.220.6</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento al punto presa di servizio per <strong>connettore tipo RJ45</strong> con cavo UTP cat. 6
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPD }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.220.6')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPD|number_format(0) * fun.getPriceByCode('15.3.220.6'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPD * fun.getPriceByCode('15.3.220.6')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.campanello != 0 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><i>Segnalatore Acustico</i></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.80.4</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento al punto presa di servizio per impianto di comando di suoneria. Con pulsante <br>
                                                    con targa.
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.80.4')|number_format(2) }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.80.4')|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.3.80.4')]) %}
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.3.90</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento al punto presa di servizio per segnalatore acustico di tipo a <strong> SUONERIA</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.90')|number_format(2) }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.90')|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.3.90')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Orologio Astronomico</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.6.170.39</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Interruttore deviatore orario giornaliero e settimanale (ris. Carica 100h) digitale ad 1 uscita.
                                            </small>
                                        </td>
                                        <td class="border text-center">1</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.6.170.39')|number_format(2) }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.6.170.39')|number_format(2) }}</td>
                                        {% set prices = prices|merge([fun.getPriceByCode('15.6.170.39')]) %}
                                    </tr>
                                    <!--<tr>
                                        <td colspan="5" class="border table-light"><i>Impianto Citofonico o Videocitofonico</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.3.52.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Incremento al punto presa di servizio per <strong>impianto citofonico o videocitofonico, sistema a 2 fili.
                                                    Per impianto base fino a 26 interni.</strong>
                                            </small>
                                        </td>
                                        <td class="border text-center">2</td>
                                        <td class="border text-center">96.00</td>
                                        <td class="border text-center">192.00</td>
                                    </tr>-->
                                    {% if itemsArray.14 > 0 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><i>Lampade emergenza</i></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.8.180.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    PLAFONIERA DI EMERGENZA INSTALLABILE SU SCATOLE PORTAFRUTTO. Su placca in alluminio anodizzato o in plastica.
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.14 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.8.180.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.14 * fun.getPriceByCode('15.8.180.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.14 * fun.getPriceByCode('15.8.180.1')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><strong>IMPIANTO DI RISCALDAMENTO</strong></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Punti Presa di Servizio</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.3.10.0</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                PUNTO PRESA DI SERVIZIO in traccia. Sono escluse le opere murarie
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPST }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.3.10')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPST * fun.getPriceByCode('15.3.10'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPST * fun.getPriceByCode('15.3.10')]) %}
                                    </tr>
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 0 %}
                                        <tr>
                                            <td class="border text-center">15.3.20.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature NON Intonacate. <br>
                                                    Sono esclusi: l’intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPST }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.20.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPST * fun.getPriceByCode('15.3.20.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPST * fun.getPriceByCode('15.3.20.1')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurarie == 1 and item.opereMurarieIntonaco == 1  %}
                                        <tr>
                                            <td class="border text-center">15.3.20.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Incremento alla canalizzazione per p.to presa di servizio per opere murarie su murature Intonacate. <br>
                                                    Sono esclusi: l'intonaco, la rasatura e la tinteggiatura
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPST }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.3.20.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (qtyPST * fun.getPriceByCode('15.3.20.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([qtyPST * fun.getPriceByCode('15.3.20.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.opereMurariePietra == 1 %}
                                        <td class="border text-center">15.3.20.3</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Maggiorazione per opere murarie su muratura in mattone pieno, calcestruzzo o pietra.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ qtyPST }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.3.20.3')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (qtyPST * fun.getPriceByCode('15.3.20.3'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([qtyPST * fun.getPriceByCode('15.3.20.3')]) %}
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Allaccio di regolazione </i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">13.21.10.0</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Collegamento elettrico di regolazione di impianti tecnologici, eseguito sottotraccia <br>
                                                per alimentare dal quadro elettrico di centrale o di zona una apparecchiatura di regololazione<br>
                                                (<strong>termostato</strong>, umidostato, flussostato, sonda di temperatura, pressostato, ecc.)
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('13.21.10')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (item.pianiCasa * fun.getPriceByCode('13.21.10'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([item.pianiCasa * fun.getPriceByCode('13.21.10')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Termostato</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">13.19.10.4</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Termostato elettronico da parete.
                                            </small>
                                        </td>
                                        <td class="border text-center">
                                            {% if itemsArray.20 == 0 %}
                                            1
                                            {% elseif itemsArray.20 == 1 %}
                                            1
                                            {% elseif itemsArray.20 > 1 %}
                                            2
                                            {% endif %}
                                        </td>
                                        <td class="border text-center">{{ fun.getPriceByCode('13.19.10.4')|number_format(2) }}</td>
                                        <td class="border text-center">
                                            {% if itemsArray.20 == 0 %}
                                                {{ fun.getPriceByCode('13.19.10.4')|number_format(2) }}
                                            {% elseif itemsArray.20 == 1 %}
                                                {{ fun.getPriceByCode('13.19.10.4')|number_format(2) }}
                                            {% elseif itemsArray.20 > 1 %}
                                                {{ fun.getPriceByCode('13.19.10.4')|number_format(2) * 2 }}
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Allaccio di Potenza</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">13.21.40.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Collegamento elettrico di potenza di apparecchiature tecnologiche, eseguito sottotraccia,<br>
                                                per alimentare dal quadro elettrico di centrale o di zona, una apparecchiatura di potenza <br>
                                                (<strong>bruciatore</strong>, elettropompa, compressore, aerotermo, unità termoventilante, aspiratore, ventilconvettore, ecc.)
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.18 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('13.21.40.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.18 * fun.getPriceByCode('13.21.40.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.18 * fun.getPriceByCode('13.21.40.1')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Allaccio Condizionatori</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">13.21.40.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Collegamento elettrico di potenza di apparecchiature tecnologiche, eseguito sottotraccia,<br>
                                                per alimentare dal quadro elettrico di centrale o di zona, una apparecchiatura di potenza <br>
                                                (bruciatore, elettropompa, compressore, <strong>aerotermo</strong>, unità termoventilante, aspiratore, <strong>ventilconvettore</strong>, ecc.)
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.17 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('13.21.40.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.17 * fun.getPriceByCode('13.21.40.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.17 * fun.getPriceByCode('13.21.40.1')]) %}
                                    </tr>
                                    {%  if itemsArray.19 > 0 %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Allaccio collettori</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">13.21.10</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Collegamento elettrico di regolazione di impianti tecnologici, eseguito sottotraccia per alimentare <br>
                                                dal quadro elettrico di centrale o di zona una apparecchiatura di regololazione (termostato, umidostato,<br>
                                                flussostato, sonda di temperatura, pressostato, ecc.)
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.19 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('13.21.10')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.19 * fun.getPriceByCode('13.21.10'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.19 * fun.getPriceByCode('13.21.10')]) %}
                                    </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Collegamento Testine nei collettori per Ambiente</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.2.70.7</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Per allaccio elettrico incluso il collegamento all'apparecchio
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.17 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.2.70.7')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.17 * fun.getPriceByCode('15.2.70.7'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.17 * fun.getPriceByCode('15.2.70.7')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light">
                                            <strong>
                                                QUADRI ELETTRICI PER IMPIANTO ELETTRICO, SERVIZI E PREDISPOSIZIONI DOMOTICHE: LE ESATTE QUANTITA' E TIPOLOGIE DEI VARI APPARATI <br>
                                                SARANNO CONTEGGIATI AL TERMINE DELLE LAVORAZIONI IN MODO DA RISPETTARE L'ESATTO COORDINAMENTO DELLE PROTEZIONI COME DA <br>
                                                NORMATIVA. ALTRIMENTI PER UN'ESATTA DEFINZIONE DEI QUADRI ELETTRICI E' NECESSARIO, PRIMA DELL'INIZIO DELLE LAVORAZIONI,  <br>
                                                AVERE IL PROGETTO DEGLI IMPIANTI TECNOLOGICI E L'ESATTA TIPOLOGIA DI UTILIZZATORI CHE VERRANNO INSTALLATI <br>
                                                (AD ESEMPIO FORNI, LAVATRICI, SAUNE, CONZIONATORI, PISCINE ECC...)
                                            </strong>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Quadri elettrici per impianto elettrico e predisposizione domotica.</i></td>
                                    </tr>
                                    {% if (itemsArray.22 > 0) %}
                                        <tr>
                                            <td class="border text-center">15.6.220.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Centralino tipo appartamento incassato a parete 12  moduli. <strong>PER CITOFONO E/O CENTRALINO</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.22 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.6.220.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.22 * fun.getPriceByCode('15.6.220.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.22 * fun.getPriceByCode('15.6.220.1')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if (itemsArray.23 > 0) %}
                                        <tr>
                                            <td class="border text-center">15.6.220.3</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Centralino tipo appartamento incassato a parete 36  moduli. <strong>PER CITOFONO E/O CENTRALINO</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.23 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.6.220.3')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.23 * fun.getPriceByCode('15.6.220.3'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.23 * fun.getPriceByCode('15.6.220.3')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if (itemsArray.24 > 0) %}
                                        <tr>
                                            <td class="border text-center">15.6.220.4</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Centralino tipo appartamento incassato a parete 54  moduli. <strong>PER CITOFONO E/O CENTRALINO</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.24 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.6.220.4')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.24 * fun.getPriceByCode('15.6.220.4'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.24 * fun.getPriceByCode('15.6.220.4')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if (itemsArray.25 > 0) %}
                                        <tr>
                                            <td class="border text-center">15.6.220.5</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Centralino tipo appartamento incassato a parete 72  moduli. <strong>PER CITOFONO E/O CENTRALINO</strong>
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ itemsArray.25 }}</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.6.220.5')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (itemsArray.25 * fun.getPriceByCode('15.6.220.5'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([itemsArray.25 * fun.getPriceByCode('15.6.220.5')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Sezionatore Quadro Generale</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.6.10.8</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Interruttore automatico magnetotermico Caratteristica C. Potere di interruzione 6KA. Bipolare da 40 a 63A.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.22 + itemsArray.23 + itemsArray.24 + itemsArray.25 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.6.10.8')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((itemsArray.22 + itemsArray.23 + itemsArray.24 + itemsArray.25) * fun.getPriceByCode('15.6.10.8'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(itemsArray.22 + itemsArray.23 + itemsArray.24 + itemsArray.25) * fun.getPriceByCode('15.6.10.8')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Interruttori magnetotermici differenziali: circuiti luce di ogni piano, Forza motrice di ogni piano, allarme, impianto antenna,<br>
                                                Domotica, centralino telefonico, linea luce esterna.</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.06.52.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Interruttore magnetotermico differenziale fino a 32A, potere di interruzione 4,5KA, I.d. 0,03A
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.numCircuiti }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.6.52.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (item.numCircuiti * fun.getPriceByCode('15.6.52.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([item.numCircuiti * fun.getPriceByCode('15.6.52.1')]) %}
                                    </tr>

                                    {% if itemsArray.25 > 0 %}
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Differenziale puro</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.06.10.8</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Interruttore automatico magnetotermico Caratteristica C. Potere di interruzione 6KA. Bipolare da 10 a 32A.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ itemsArray.25 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.06.10.8')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (itemsArray.25 * fun.getPriceByCode('15.06.10.8'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([itemsArray.25 * fun.getPriceByCode('15.06.10.8')]) %}
                                    </tr>
                                    {% endif %}
                                    <tr>
                                        <td colspan="5" class="border table-light">
                                            <strong>
                                                QUOTA LINEE DORSALI: LE ESATTE QUANTITA' E TIPOLOGIE DEI CAVI E DEI CORRUGATI  SARANNO CONTEGGIATE AL TERMINE DELLE LAVORAZIONI <br>
                                                IN QUANTO ALLO STATO ATTUALE NON E' POSSOBILE DETERMINARE L'ESATTA POSIZIONE DELLE SCATOLE DI DERIVAZIONE E DELLA COLONNA MONTANTE <br>
                                                PER MOTIVI ARCHITETTONICI E/O STRUTTURALI.
                                            </strong>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Quota cavi linea dorsale per impianto elettrico linee dorsali</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.4.110.12</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Linea Elettrica in cavo unipolare isolato in PVC, NO7V-K  1*6mmq al metro
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa * 15 * 3 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.4.110.12')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((item.pianiCasa * 15 * 3) * fun.getPriceByCode('15.4.110.12'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(item.pianiCasa * 15 * 3) * fun.getPriceByCode('15.4.110.12')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><i>Quota corrugati per dorsale e relativa traccia</i></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.5.10.3</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Tubazione flessibile in PVC autoestinguente serie pesante IMQ. Diametro esterno mm 25. Al metro.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa * 15 * 2 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.5.10.3')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((item.pianiCasa * 15 * 2) * fun.getPriceByCode('15.5.10.3'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(item.pianiCasa * 15 * 2) * fun.getPriceByCode('15.5.10.3')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.5.10.4</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Tubazione flessibile in PVC autoestinguente serie pesante IMQ. Diametro esterno mm 32. Al metro.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa * 15 * 2 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.5.10.4')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((item.pianiCasa * 15 * 2) * fun.getPriceByCode('15.5.10.4'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(item.pianiCasa * 15 * 2) * fun.getPriceByCode('15.5.10.4')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.5.180.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Traccia su muratura di qualsiasi genere esclusa quella in pietra e in calcestruzzo. <br>
                                                Per larghezza della traccia fino a 10 cm al metro lineare.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa * 4 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.5.180.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((item.pianiCasa * 4) * fun.getPriceByCode('15.5.180.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(item.pianiCasa * 15 * 2) * fun.getPriceByCode('15.5.180.1')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.5.180.2</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Traccia su muratura di qualsiasi genere esclusa quella in pietra e in calcestruzzo. <br>
                                                Per larghezza della traccia fino a 10 cm al metro lineare.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa * 2 * 3 }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.5.180.2')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((item.pianiCasa * 2 * 3) * fun.getPriceByCode('15.5.180.2'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(item.pianiCasa * 15 * 2) * fun.getPriceByCode('15.5.180.2')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light">
                                            <i>
                                                Scatole derivazione per predisposizione domotica. Queste scatole consentono in futuro di poter allocare in campo <br>
                                                eventuali dispositivi domotici.
                                            </i>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.5.80.8</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Scatola di derivazione in plastica da incasso. Dimensioni assimilabili a mm 392x152x70.
                                            </small>
                                        </td>
                                        <td class="border text-center">{{ item.pianiCasa  }}</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.5.80.8')|number_format(2) }}</td>
                                        <td class="border text-center">{{ ((item.pianiCasa) * fun.getPriceByCode('15.5.80.8'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([(item.pianiCasa) * fun.getPriceByCode('15.5.80.8')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><strong>INGRESSO LINEA ELETTRICA ENEL DIMENSIONATA PER FORNITURA 4,5KW</strong></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light">
                                            <i>
                                                Ingresso linea cavi impianto elettrico misura ipotetica: <u>L'esatta misura e/o sezione verrà conteggiata nel momento in cui verrà <br>
                                                    stabilita la posizione del contatore e la fornitura di allaccio se monofase o trifase</u>
                                            </i>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.4.21.40</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Linea Elettrica in cavo multipolare isolato in EPR sotto guaina di PVC, sigla RG70R 0,6/1KV o FG70R 0,6/1KV 2*10mmq al metro.
                                            </small>
                                        </td>
                                        <td class="border text-center">20</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.4.21.40')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (20 * fun.getPriceByCode('15.4.21.40'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([20 * fun.getPriceByCode('15.4.21.40')]) %}
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="border table-light"><strong>IMPIANTO DI MESSA A TERRA</strong></td>
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.4.110.10</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                LINEA ELETTRICA IN CAVO UNIPOLARE ISOLATO IN PVC.  Linea elettrica in cavo <br>
                                                unipolare isolato in sigla di designazione NO7V-K (norme CEI 20-20 , CEI 20-22,<br>
                                                CEI 20-35) del tipo non propagante l'incendio. 16 mm2
                                            </small>
                                        </td>
                                        <td class="border text-center">20</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.4.110.10')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (20 * fun.getPriceByCode('15.4.110.10'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([20 * fun.getPriceByCode('15.4.110.10')]) %}
                                    </tr>
                                    {% if item.spd == "1" %}
                                        {% if item.trifase == 0 %}
                                            <tr>
                                                <td class="border text-center">15.7.201</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Scaricatore per corrente di fulmine Unipolare  SPD Tipo 1. <br>
                                                        Per ogni polo di fase protetto.
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.7.201')|number_format(2) }}</td>
                                                <td class="border text-center">{{ (fun.getPriceByCode('15.7.201'))|number_format(2) }}</td>
                                                {% set prices = prices|merge([fun.getPriceByCode('15.7.201')]) %}
                                            </tr>
                                            <tr>
                                                <td class="border text-center">15.7.202</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Scaricatore per corrente di fulmine N-PE SPD Tipo 1
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.7.202')|number_format(2) }}</td>
                                                <td class="border text-center">{{ (fun.getPriceByCode('15.7.202'))|number_format(2) }}</td>
                                                {% set prices = prices|merge([fun.getPriceByCode('15.7.202')]) %}
                                            </tr>
                                        {% else %}
                                            <tr>
                                                <td class="border text-center">15.7.201</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Scaricatore per corrente di fulmine Unipolare  SPD Tipo 1. <br>
                                                        Per ogni polo di fase protetto.
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.7.201')|number_format(2) }}</td>
                                                <td class="border text-center">{{ (fun.getPriceByCode('15.7.201'))|number_format(2) }}</td>
                                                {% set prices = prices|merge([fun.getPriceByCode('15.7.201')]) %}
                                            </tr>
                                            <tr>
                                                <td class="border text-center">15.7.202</td>
                                                <td class="text-small border" style="max-width: 300px">
                                                    <small>
                                                        Scaricatore per corrente di fulmine N-PE  SPD Tipo 1
                                                    </small>
                                                </td>
                                                <td class="border text-center">1</td>
                                                <td class="border text-center">{{ fun.getPriceByCode('15.7.202')|number_format(2) }}</td>
                                                <td class="border text-center">{{ (3 * fun.getPriceByCode('15.7.202'))|number_format(2) }}</td>
                                                {% set prices = prices|merge([3 * fun.getPriceByCode('15.7.202')]) %}
                                            </tr>
                                        {% endif %}
                                    {% else %}
                                        <tr>
                                            <td class="border text-center">15.7.204.4</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Limitatore di sovratensioni (SPD) Tipo 2. Quadripolare per reti TT (esecuzione 3+1).
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.7.204.4')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (fun.getPriceByCode('15.7.204.4'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.7.204.4')]) %}
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.7.201</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Scaricatore per corrente di fulmine N-PE SPD Tipo 2
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.7.201')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (fun.getPriceByCode('15.7.201'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.7.201')]) %}
                                        </tr>
                                    {% endif %}
                                    <tr>
                                        <td class="border text-center">15.5.260.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Pozzetto in resina completo di coperchio carrabile. 300x300mm
                                            </small>
                                        </td>
                                        <td class="border text-center">1</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.5.260.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (fun.getPriceByCode('15.5.260.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([fun.getPriceByCode('15.5.260.1')]) %}
                                    </tr>
                                    <tr>
                                        <td class="border text-center">15.7.60.1</td>
                                        <td class="text-small border" style="max-width: 300px">
                                            <small>
                                                Puntazza a croce per dispersione, realizzate in acciaio zincato a fuoco di dimensioni 50*50*5mm,<br>
                                                da conficcare in terreno di media consistenza all'interno di pozzetto ispezionabile, fornita e posta in opera.<br>
                                                Di lunghezza pari a 1,5 mt
                                            </small>
                                        </td>
                                        <td class="border text-center">1</td>
                                        <td class="border text-center">{{ fun.getPriceByCode('15.7.60.1')|number_format(2) }}</td>
                                        <td class="border text-center">{{ (fun.getPriceByCode('15.7.60.1'))|number_format(2) }}</td>
                                        {% set prices = prices|merge([fun.getPriceByCode('15.7.60.1')]) %}
                                    </tr>
                                    {% if item.opereMurarie == 0 %}
                                        <tr>
                                            <td class="border text-center">15.2.160.1</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Nodo equipotenziale, costituito da barretta in rame forata. Escluse le opere murarie.
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.2.160.1')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (fun.getPriceByCode('15.2.160.1'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.2.160.1')]) %}
                                        </tr>
                                    {% else %}
                                        <tr>
                                            <td class="border text-center">15.2.160.2</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Nodo equipotenziale, costituito da barretta in rame forata. Comprese le opere murarie.
                                                </small>
                                            </td>
                                            <td class="border text-center">1</td>
                                            <td class="border text-center">{{ fun.getPriceByCode('15.2.160.2')|number_format(2) }}</td>
                                            <td class="border text-center">{{ (fun.getPriceByCode('15.2.160.2'))|number_format(2) }}</td>
                                            {% set prices = prices|merge([fun.getPriceByCode('15.2.160.2')]) %}
                                        </tr>
                                    {% endif %}
                                    {% if item.level == 3 %}
                                        <tr>
                                            <td colspan="5" class="border table-light"><strong>Relè Passo Passo ed alimentatori già suddivisi per piano: NECESSARI PER LA GESTIONE DELL'ILLUMINAZIONE IN BASSA TENSIONE</strong></td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.6.170.31</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Apparecchi modulari da inserire su quadro elettrico con attacco DIN, forniti e posti in opera.<br>
                                                    Sono compresi: il cablaggio, gli accessori, il montaggio, E’ compreso quanto altro occorre per dare <br>
                                                    il lavoro finito. E’ esclusa la quota di carpenteria. Relè passo-passo 1 contatto 16A
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ qtyPL }}</td>
                                            <td class="border text-center">27.00</td>
                                            <td class="border text-center">{{ qtyPL * 27 }}</td>
                                        </tr>
                                        <tr>
                                            <td class="border text-center">15.6.170.44</td>
                                            <td class="text-small border" style="max-width: 300px">
                                                <small>
                                                    Apparecchi modulari da inserire su quadro elettrico con attacco DIN, forniti e posti in opera.<br>
                                                    Sono compresi: il cablaggio, gli accessori, il montaggio, E’ compreso quanto altro occorre per dare<br>
                                                    il lavoro finito. E’ esclusa la quota di carpenteria. Trasformatore BTS secondario 24V 40VA
                                                </small>
                                            </td>
                                            <td class="border text-center">{{ item.pianiCasa }}</td>
                                            <td class="border text-center">40</td>
                                            <td class="border text-center">{{ item.pianiCasa * 40 }}</td>
                                        </tr>
                                    {% endif %}

                                    <!-- TOTALI -->
                                    <tr>
                                        <td colspan="3" class="border-0"></td>
                                        <td class="border">SUBTOTALE</td>
                                        <td class="border text-center">
                                            {% set total = 0 %}
                                            {% for row in prices|batch(2) %}
                                                {% for column in row %}
                                                    {% set total = total + column %}
                                                {% endfor %}
                                            {% endfor %}
                                            {{ total }} €
                                        </td>
                                    </tr>
                                    {% if sconto != 0 %}
                                        <tr>
                                            <td colspan="3" class="border-0"></td>
                                            <td class="border">SCONTO {{ item.sconto }}%</td>
                                            <td class="border text-center">
                                                {% set sconto = (total * item.sconto) / 100  %}
                                                {{ sconto }} €
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3" class="border-0"></td>
                                            <td class="border"><strong>TOTALE SCONTATO</strong></td>
                                            <td class="border text-center">
                                                <strong>{{ (total - sconto)|round('2') }} €</strong>
                                            </td>
                                        </tr>
                                    {% else %}
                                        <tr>
                                            <td colspan="3" class="border-0"></td>
                                            <td class="border"><strong>TOTALE</strong></td>
                                            <td class="border text-center">
                                                <strong>{%  set grandtotal = total + vat - sconto %} {{ grandtotal|round('2') }} €</strong>
                                            </td>
                                        </tr>
                                    {% endif %}
                                    {#<tr>
                                        <td colspan="3" class="border-0"></td>
                                        <td class="border">IVA 22%</td>
                                        <td class="border text-center">
                                            {{ vat|round('2') }} €
                                        </td>
                                    </tr>#}
{% dump(prices) %}

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block stylesheets %}
    <style>
        .no-wrap {
            max-width: 130px;
            width: 130px;
            white-space: pre-wrap!important; /* css-3 */
            white-space: -moz-pre-wrap!important; /* Mozilla, since 1999 */
            white-space: -pre-wrap!important; /* Opera 4-6 */
            white-space: -o-pre-wrap!important; /* Opera 7 */
            word-wrap: break-word!important; /* Internet Explorer 5.5+ */
        }
        .description {
            max-width: 300px;
            white-space: pre-wrap!important; /* css-3 */
            white-space: -moz-pre-wrap!important; /* Mozilla, since 1999 */
            white-space: -pre-wrap!important; /* Opera 4-6 */
            white-space: -o-pre-wrap!important; /* Opera 7 */
            word-wrap: break-word!important; /* Internet Explorer 5.5+ */
        }
        td {
            height: 65px!important;
        }
        .text-small {
            font-size: 10px!important;
        }
    </style>
    <style type="text/css">
        {# TODO: Fix print CSS #}
        @page {
            /*size: landscape;*/
            margin: 0; }
        @media print {
            * {
                font-size: 0.9em!important;
            }
            small {
                font-size: 0.8em!important;
            }
            #page {
                max-width: 23cm!important;
                width: 23cm!important;
            }
            .footer {
                display: none;
            }
            .sf-toolbar {
                display: none;
            }
            .top-title {
                display: none;
            }
            .navbar {
                display: none;
            }
            .navbar-toggler {
                display: none;
            }
            .nav-hide-btn {
                display: none;
            }
            .title-dettagli {
                display: none;
            }
            .ambient-td {
                display: none;
            }
            .ambient-th {
                display: none;
            }
            a {
                text-decoration: none!important;
                color: #000000!important;
            }
            .card-grey {
                border: 1px solid #EEEEEE!important;
            }
            .card {
                padding: 0!important;
                margin: 0!important;
            }
            .table-header {
                background-color: #EEEEEE!important;
            }
            .table td {
                padding: 0px 20px!important;
                margin-left:5px;
                height: 40px!important;
            }
            .action-buttons {
                display: none;
            }
        }
    </style>
{% endblock %}
{% block javascripts %}
    <script>
        $(document).ready(function () {
            $('#nav-hide-btn-icon').trigger('click');
        });
        $('#print').click(function(e) {
            e.preventDefault();
            window.print();
            return false;
        })
    </script>
{% endblock %}